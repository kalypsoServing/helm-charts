# Tempo distributed configuration with MinIO backend
# Reference: https://github.com/grafana/helm-charts/tree/main/charts/tempo-distributed

# Storage configuration using MinIO S3-compatible storage
storage:
  trace:
    backend: s3
    s3:
      bucket: tempo-bucket
      endpoint: minio.minio.svc.cluster.local:9000
      access_key: rootuser
      secret_key: rootpass123
      insecure: true
      # For production, use secrets instead:
      # access_key: ${MINIO_ACCESS_KEY_ID}
      # secret_key: ${MINIO_SECRET_ACCESS_KEY}

minio:
  enabled: false

# Gateway configuration
gateway:
  enabled: true
  replicas: 1

# Distributor configuration
distributor:
  replicas: 1

# Ingester configuration
ingester:
  replicas: 1
  persistence:
    enabled: false  # Using S3, no local persistence needed

# Tempo structured configuration
tempo:
  structuredConfig:
    ingester:
      lifecycler:
        ring:
          replication_factor: 1  # 단일 replica를 위한 설정 (개발 환경)

# Compactor configuration
compactor:
  replicas: 1

# Querier configuration
querier:
  replicas: 1

# Query Frontend configuration
queryFrontend:
  replicas: 1

# Metrics Generator (optional)
metricsGenerator:
  enabled: false
  replicas: 1

# Global overrides
global_overrides:
  per_tenant_override_config: /conf/overrides.yaml

# Traces configuration
traces:
  otlp:
    http:
      enabled: true
    grpc:
      enabled: true
  zipkin:
    enabled: false
  jaeger:
    thriftHttp:
      enabled: true
  opencensus:
    enabled: false
